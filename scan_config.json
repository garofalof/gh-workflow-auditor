{
  "rce_risks": {
    "unsafe_inputs": {
      "user_input_body_title": "\\${{\\s*github.event.(.*).(body|title)\\s*}}",
      "malicious_commit_message": "\\${{\\s*(.*).head_commit.message\\s*}}",
      "malicious_input": "\\${{\\s*(.*)github.event.review(.*)\\s*}}",
      "environ_regex": "\\${{\\s*env.[A-Za-z0-9_-]*\\s*}}",
      "malicious_author": "\\${{\\s*github.event.(.*).author.(name|email)\\s*}}"
    },
    "malicious_commits": {
      "malicious_commit_referenced": "\\${{\\s*github.pull_request.head(.*)\\s*}}",
      "malicious_pull_request_event": "\\${{\\s*(.*)github.event.pull_request.head(.*)\\s*}}"
    }
  },
  "secrets": "\\${{\\s*secrets\\.[A-Za-z-_0-9]*\\s*}}",
  "risky_events": ["pull_request_target", "issues", "issue_comment"],
  "cloud_commands": {
    "aws": {
      "aws_sts_assume_role": "aws\\s+sts\\s+assume-role\\s+--role-arn\\s+arn:aws:iam::\\d{12}:role/\\S+",
      "aws_signing_helper": "aws_signing_helper"
    },
    "gcp": {
      "gcloud_auth_activate_service_account": "gcloud\\s+auth\\s+activate-service-account\\s+--key-file\\s+\\S+"
    },
    "azure": {
      "az_login_with_service_principal": "az\\s+login\\s+--service-principal\\s+(?:--username\\s+\\S+\\s+--password\\s+\\S+\\s+--tenant\\s+\\S+|--credential\\s+\\S+)"
    }
  },
  "kubernetes_patterns": {
    "kubectl_with_kubeconfig_flag": "kubectl\\s+(?:.*?\\s+)?--kubeconfig\\s+\\S+",
    "kubectl_with_kubeconfig_env": "KUBECONFIG:\\s*([\"']?)(?:(?!\\1).)*\\1",
    "helm_with_kubeconfig_flag": "helm\\s+(?:.*?\\s+)?--kubeconfig\\s+\\S+",
    "helm_with_kubeconfig_env": "KUBECONFIG:\\s*([\"']?)(?:(?!\\1).)*\\1",
    "kubeconfig_from_secret": "(?:\\${{)?\\s*secrets\\.KUBECONFIG\\s*(?:}})?|\\$KUBECONFIG"
  },
  "external_resource_patterns": {
    "mysql": "mysql://([^:]+|\\$\\{[^}]+\\}):([^@]+|\\$\\{[^}]+\\})@([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\})/([\\w]+|\\$\\{[^}]+\\})",
    "postgresql": "postgresql://([^:]+|\\$\\{[^}]+\\}):([^@]+|\\$\\{[^}]+\\})@([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\})/([\\w]+|\\$\\{[^}]+\\})",
    "mongodb": "mongodb(\\+srv)?://([^:]+|\\$\\{[^}]+\\}):([^@]+|\\$\\{[^}]+\\})@([^/]+|\\$\\{[^}]+\\})/([\\w]+|\\$\\{[^}]+\\})",
    "sqlserver": "sqlserver://([^:]+|\\$\\{[^}]+\\}):([^@]+|\\$\\{[^}]+\\})@([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\});database=([\\w]+|\\$\\{[^}]+\\})",
    "oracle": "oracle:([\\w]+|\\$\\{[^}]+\\})/([\\w]+|\\$\\{[^}]+\\})@//([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\})/([\\w]+|\\$\\{[^}]+\\})",
    "redis": "redis://:([^@]+|\\$\\{[^}]+\\})@([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\})",
    "ssh": "ssh://([^:]+|\\$\\{[^}]+\\}):([^@]+|\\$\\{[^}]+\\})@([^:]+|\\$\\{[^}]+\\}):(\\d+|\\$\\{[^}]+\\})"
  }
}
